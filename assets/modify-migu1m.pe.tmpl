#!{{.FontForge}} -script

Print("Generate modified Migu 1M")

# Set parameters
input_list  = ["{{.SrcRegular}}", "{{.SrcBold}}", "{{.SrcOblique}}", "{{.SrcBoldOblique}}"]
output_list  = ["{{.DstRegular}}", "{{.DstBold}}", "{{.DstOblique}}", "{{.DstBoldOblique}}"]

# Begin loop of regular and bold
i = 0
while (i < SizeOf(input_list))
    # Open Migu 1M
    Print("Open " + input_list[i])
    Open(input_list[i])
    SelectWorthOutputting()
    UnlinkReference()
    ScaleToEm({{.Ascent}}, {{.Descent}})

    # Scale down all glyphs
    Print("Move all glyphs to center (it may take a few minutes)")
    SelectWorthOutputting()
    Move({{.Padding}}, 0); SetWidth({{.Padding}}, 1)

    RoundToInt(); RemoveOverlap(); RoundToInt()

    # Clear instructions
    Print("Clear instructions")
    SelectWorthOutputting()
    ClearInstrs()

    # Save modified Migu 1M
    Print("Save " + output_list[i])
    Save("{{.DstDir}}/" + output_list[i])
    Close()

    i += 1
endloop

Quit()

# vim:se ft=fontforge_script.gotexttmpl:
